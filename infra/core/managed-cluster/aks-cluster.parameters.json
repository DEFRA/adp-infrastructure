{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentParameters.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "vnet": {
      "value": {
        "name": "#{{ virtualNetworkName }}",
        "resourceGroup": "#{{ virtualNetworkResourceGroup }}",
        "subnet02Name": "#{{ networkResourceNamePrefix }}#{{ nc_resource_subnet }}#{{ nc_instance_regionid }}98",
        "subnet03Name": "#{{ networkResourceNamePrefix }}#{{ nc_resource_subnet }}#{{ nc_instance_regionid }}03"
      }
    },
    "cluster": {
      "value": {
        "name": "#{{ infraResourceNamePrefix }}#{{ nc_resource_kubernetesservice }}#{{ nc_instance_regionid }}01",
        "kubernetesVersion": "#{{ aksVersion }}",
        "skuTier": "#{{ aksClusterSkuTier }}",
        "nodeResourceGroup": "#{{ aksResourceGroup }}-Managed",
        "miControlPlane": "#{{ aksControlPlaneManagedIdentity }}",
        "adminAadGroupObjectId": "#{{ aksAADProfileAdminGroupObjectId }}",
        "podCidr": "#{{ aksClusterPodCidr }}",
        "serviceCidr": "#{{ aksClusterServiceCidr }}",
        "dnsServiceIp": "#{{ aksClusterDnsServiceIp }}",
        "npSystem": {
          "count": 2,
          "osDiskSizeGB": 80,
          "maxCount": 4,
          "minCount": 1,
          "maxPods": 80,
          "availabilityZones": [
            "1",
            "2",
            "3"
          ]
        },
        "npUser": {
          "count": 2,
          "osDiskSizeGB": 128,
          "maxCount": 10,
          "minCount": 2,
          "maxPods": 80,
          "minPods": 2,
          "availabilityZones": [
            "1",
            "2",
            "3"
          ]
        }
      }
    },
    "privateDnsZone": {
      "value": {
        "prefix": "#{{ dnsResourceNamePrefix }}#{{ nc_resource_dnszone }}#{{ nc_instance_regionid }}01",
        "resourceGroup": "#{{ dnsResourceGroup }}"
      }
    },
    "containerRegistry": {
      "value": {
        "name": "#{{ infraResourceNamePrefix }}#{{ nc_resource_containerregistry }}#{{ nc_instance_regionid }}01",
        "resourceGroup": "#{{ servicesResourceGroup }}",
        "subscriptionId": "#{{ subscriptionId }}"
      }
    },
    "location": {
      "value": "#{{ location }}"
    },
    "environment": {
      "value": "#{{ environment }}"
    },
    "monitoringWorkspace": {
      "value": {
        "name": "#{{ logAnalyticsWorkspace }}",
        "resourceGroup": "#{{ servicesResourceGroup }}"
      }
    },
    "fluxConfig": {
      "value": {
        "clusterCore": {
          "gitRepository": {
            "syncIntervalInSeconds": 300,
            "timeoutInSeconds": 180,
            "url": "https://github.com/DEFRA/adp-flux-core",
            "branch": "main"
          },
          "kustomizations": {
            "timeoutInSeconds": 600,
            "syncIntervalInSeconds": 600,
            "clusterPath": "./clusters/#{{ lower(environment) }}/0#{{ environmentId }}",
            "infraPath": "./infra/#{{ lower(environment) }}/0#{{ environmentId }}",
            "servicesPath": "./services/#{{ lower(environment) }}/0#{{ environmentId }}",
            "postBuild": {
              "substitute": {
                "ENVIRONMENT": "#{{ lower(environment) }}",
                "ACR_NAME": "#{{ infraResourceNamePrefix }}#{{ nc_resource_containerregistry }}#{{ nc_instance_regionid }}01",
                "CLUSTER": "0#{{ environmentId }}",
                "SERVICEBUS_RG": "#{{ servicesResourceGroup }}",
                "SERVICEBUS_NS": "#{{ infraResourceNamePrefix }}#{{ nc_resource_servicebus }}#{{ nc_instance_regionid }}01",
                "POSTGRES_SERVER_RG": "#{{ dbsResourceGroup }}",
                "POSTGRES_SERVER": "#{{ dbsResourceNamePrefix }}#{{ nc_resource_postgresql }}#{{ nc_instance_regionid }}01",
                "INFRA_RG": "#{{ servicesResourceGroup }}",
                "TEAM_MI_NAME": "#{{ infraResourceNamePrefix }}#{{ nc_resource_managedidentity }}#{{ nc_instance_regionid }}01",
                "CLUSTER_OIDC": "",
                "TENANT_ID": "#{{ tenantId }}",
                "SUBSCRIPTION_ID": "#{{ subscriptionId }}",
                "SUBSCRIPTION_NAME": "#{{ subscriptionName }}"
              }
            }
          }
        }
      }
    },
    "asoPlatformManagedIdentity": {
      "value": "#{{ infraResourceNamePrefix }}#{{ nc_resource_managedidentity }}#{{ nc_instance_regionid }}01-adp-aso-platform"
    }
  }
}